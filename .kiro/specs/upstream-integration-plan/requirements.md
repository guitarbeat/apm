# Requirements Document

## Introduction

Transform phd-apm from a parallel Agentic Project Management (APM) system into a domain-specific extension of upstream-apm v0.5. This integration will leverage upstream's proven CLI infrastructure and patterns while preserving phd-apm's specialized manuscript review capabilities, 26-agent coordination system, and Python automation tools.

## Glossary

- **PhD-APM**: A specialized APM system designed for academic manuscript review, featuring 26 specialized agents organized in phases (Section, Rigor, Writing, Quality Control, Executive Summary)
- **Upstream-APM**: The foundational APM framework (v0.5) providing core patterns, CLI tools, templates, and guides for general-purpose agentic project management
- **Setup Agent**: The agent responsible for project initialization, context gathering, and implementation plan creation
- **Manager Agent**: The coordination agent that orchestrates multiple Implementation Agents and manages workflow execution
- **Implementation Agent**: Specialized agents that execute specific tasks (phd-apm has 26 of these)
- **Bootstrap Prompt**: A structured initialization prompt generated by the Setup Agent for the Manager Agent
- **YAML Frontmatter**: Metadata header in markdown files using YAML format for agent configuration
- **Guide Reference Pattern**: Upstream's syntax for referencing guide documents: `{GUIDE_PATH:filename.md}`
- **Memory Log**: Structured documentation of agent findings and progress
- **Domain Extension**: A specialized configuration of upstream-apm for specific use cases (manuscript review in this case)

## Requirements

### Requirement 1

**User Story:** As a phd-apm maintainer, I want to adopt upstream v0.5 agent patterns, so that phd-apm benefits from proven APM structures and future upstream improvements

#### Acceptance Criteria

1. WHEN the Setup Agent is invoked, THE System SHALL follow upstream's 5-phase structure (Context Synthesis, Project Breakdown, Review, Enhancement, Bootstrap)
2. WHEN any agent references a guide document, THE System SHALL use upstream's `{GUIDE_PATH:filename.md}` reference pattern
3. WHEN an Implementation Agent is initialized, THE System SHALL include YAML frontmatter with metadata fields (priority, command_name, description, agent_id, domain)
4. WHEN the Manager Agent processes a Bootstrap Prompt, THE System SHALL follow upstream's Bootstrap Prompt pattern with YAML frontmatter
5. WHEN any agent creates a Memory Log, THE System SHALL reference upstream's Memory_Log_Guide.md

### Requirement 2

**User Story:** As a manuscript reviewer, I want phd-apm to preserve its specialized 26-agent system and manuscript-specific analysis capabilities, so that I can continue conducting thorough academic reviews

#### Acceptance Criteria

1. THE System SHALL maintain all 26 specialized Implementation Agents (S1-S10 for sections, R1-R7 for rigor, W1-W7 for writing, plus QC and ES)
2. WHEN conducting manuscript analysis, THE System SHALL preserve domain-specific evaluation criteria for each agent
3. WHEN the Manager Agent coordinates agents, THE System SHALL execute the 3-phase parallel model (Section→Rigor+Writing→QC→ES)
4. WHEN the Setup Agent gathers context, THE System SHALL include manuscript-specific questions (manuscript type, target outlet, research field, review priorities)
5. THE System SHALL maintain all manuscript-specific guides in the 06-guides directory

### Requirement 3

**User Story:** As a manuscript reviewer, I want the `02-setup_review.py` automation script to generate upstream-compatible artifacts, so that I can quickly initialize reviews with proper structure

#### Acceptance Criteria

1. WHEN `02-setup_review.py` is executed, THE System SHALL generate a metadata.json file containing APM version, domain, manuscript metadata, and phase status
2. WHEN `02-setup_review.py` generates an Implementation Plan, THE System SHALL use upstream's format with proper guide references
3. WHEN `02-setup_review.py` generates a Bootstrap Prompt, THE System SHALL include YAML frontmatter matching upstream's pattern
4. WHEN `02-setup_review.py` creates workspace artifacts, THE System SHALL reference upstream guides using the correct path structure
5. THE System SHALL preserve all existing CLI flags and behavior of `02-setup_review.py`

### Requirement 4

**User Story:** As a phd-apm user, I want access to upstream's core guides alongside manuscript-specific guides, so that I understand both foundational APM patterns and domain specialization

#### Acceptance Criteria

1. THE System SHALL include upstream's 7 core guides in the `06-guides/upstream/` directory (Context_Synthesis_Guide.md, Implementation_Plan_Guide.md, Memory_Log_Guide.md, Memory_System_Guide.md, Project_Breakdown_Guide.md, Project_Breakdown_Review_Guide.md, Task_Assignment_Guide.md)
2. THE System SHALL maintain manuscript-specific guides in the `06-guides/` root directory
3. WHEN a user accesses `06-guides/README.md`, THE System SHALL provide clear navigation to both upstream and manuscript-specific guide sets
4. WHEN agents reference guides, THE System SHALL use correct relative paths to either upstream or manuscript-specific guides
5. THE System SHALL ensure no broken links exist in guide references

### Requirement 5

**User Story:** As a phd-apm user with existing in-progress reviews, I want backward compatibility maintained where feasible, so that I can complete current reviews without disruption

#### Acceptance Criteria

1. WHEN existing review workspaces are accessed, THE System SHALL continue to function with legacy artifact formats
2. WHEN `02-setup_review.py` is executed, THE System SHALL support both legacy and new artifact generation modes
3. THE System SHALL provide a migration guide documenting differences between legacy and upstream-integrated versions
4. WHEN new reviews are initiated, THE System SHALL use upstream-compatible patterns by default
5. THE System SHALL document any breaking changes in the migration guide

### Requirement 6

**User Story:** As a phd-apm contributor, I want comprehensive documentation explaining the upstream relationship and integration approach, so that I can understand the system architecture and contribute effectively

#### Acceptance Criteria

1. WHEN a user reads `01-START_HERE.md`, THE System SHALL explain the relationship between phd-apm and upstream-apm
2. WHEN a user reads `01-START_HERE.md`, THE System SHALL document the new workflow with upstream patterns
3. THE System SHALL provide a migration guide for users transitioning from legacy phd-apm
4. WHEN a user reads `AGENTS.md`, THE System SHALL document upstream integration guidelines for contributors
5. THE System SHALL update the root README.md to reflect the upstream integration

### Requirement 7

**User Story:** As a phd-apm maintainer, I want all agent prompts to follow consistent upstream patterns, so that the system is maintainable and aligned with upstream evolution

#### Acceptance Criteria

1. WHEN any Implementation Agent is reviewed, THE System SHALL show YAML frontmatter with required metadata fields
2. WHEN any agent prompt is reviewed, THE System SHALL use upstream's execution pattern documentation (single-step vs multi-step)
3. WHEN any agent references debugging, THE System SHALL follow upstream's debug delegation protocol
4. WHEN any agent documents handovers, THE System SHALL follow upstream's handover awareness patterns
5. THE System SHALL provide a base template (`implementation_agent_base_prompt.md`) documenting upstream patterns for all 26 agents

### Requirement 8

**User Story:** As a quality assurance tester, I want the integrated system to be validated end-to-end, so that I can confirm all components work together correctly

#### Acceptance Criteria

1. WHEN the complete workflow is executed, THE System SHALL successfully run from `02-setup_review.py` through Setup Agent, Manager Agent, and sample Implementation Agent tasks
2. WHEN guide references are validated, THE System SHALL resolve all `{GUIDE_PATH:}` references correctly
3. WHEN Memory Logs are created, THE System SHALL follow upstream's Memory Log format
4. WHEN metadata tracking is checked, THE System SHALL correctly update phase status in metadata.json
5. THE System SHALL document any critical issues found during end-to-end testing

### Requirement 9

**User Story:** As a phd-apm user, I want the Setup Agent to generate Bootstrap Prompts in upstream format, so that the Manager Agent can initialize correctly with proper context

#### Acceptance Criteria

1. WHEN the Setup Agent completes Phase 5, THE System SHALL generate a Bootstrap Prompt with YAML frontmatter
2. WHEN the Bootstrap Prompt is generated, THE System SHALL include workspace_root, manuscript_type, and target_outlet metadata
3. WHEN the Bootstrap Prompt is generated, THE System SHALL reference upstream guides for Manager responsibilities
4. WHEN the Bootstrap Prompt is generated, THE System SHALL document the 5-phase manuscript review workflow
5. WHEN the Bootstrap Prompt is generated, THE System SHALL include the 26-agent coordination strategy

### Requirement 10

**User Story:** As a phd-apm maintainer, I want clear success metrics and validation criteria, so that I can confirm the integration is complete and functional

#### Acceptance Criteria

1. THE System SHALL document success metrics for pattern adoption (all agents use upstream v0.5 patterns)
2. THE System SHALL document success metrics for functionality preservation (all 26 agents maintain capabilities)
3. THE System SHALL document success metrics for automation enhancement (`02-setup_review.py` generates upstream artifacts)
4. THE System SHALL document success metrics for documentation completeness (all docs updated, migration guide created)
5. THE System SHALL document success metrics for testing validation (end-to-end workflow validated successfully)
